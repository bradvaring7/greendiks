<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Connectivity Check</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="fixed-top">Brad Varing</div>
  <nav class="sidebar">
    <a href="index.html"><span class="material-symbols-outlined sidebar-icon" title="Home">home</span></a>
    <a href="callflow.html"><span class="material-symbols-outlined sidebar-icon" title="Call Flow">call</span></a>
    <a href="essentials.html"><span class="material-symbols-outlined sidebar-icon" title="Essentials">home_repair_service</span></a>
    <a href="scheduling.html"><span class="material-symbols-outlined sidebar-icon" title="Scheduling">calendar_month</span></a>
    <a href="billing.html"><span class="material-symbols-outlined sidebar-icon" title="Billing">attach_money</span></a>
    <a href="services.html"><span class="material-symbols-outlined sidebar-icon" title="Services">house_with_shield</span></a>
    <a href="prosupport.html"><span class="material-symbols-outlined sidebar-icon" title="Pro Support">shield_person</span></a>
    <a href="connectivity.html"><span class="material-symbols-outlined sidebar-icon  icon-active" title="Connectivity Test">wifi</span></a>
    <a href="contacts.html"><span class="material-symbols-outlined sidebar-icon" title="Contacts">contacts</span></a>
  </nav>
  <div class="dashboard-container">
    <main class="main-content">
      <div class="section-title">Connectivity Check</div>
      <div class="dashboard-grid" style="margin-top:2em;">
        <div class="dashboard-card" id="status-box">
          <div class="card-title"><span class="material-symbols-outlined">wifi</span>Internet Status</div>
          <div class="card-description">
            <div id="connection-status" class="s">Checking...</div>
          </div>
        </div>
        <div class="dashboard-card" id="wifi-box" style="display:none;">
          <div class="card-title"><span class="material-symbols-outlined">signal_wifi_statusbar_4_bar</span>WiFi Strength</div>
          <div class="card-description">
            <div id="wifi-strength" class="s">Not available</div>
          </div>
        </div>
        <div class="dashboard-card" id="speedtest-box">
          <div class="card-title"><span class="material-symbols-outlined">speed</span>Speed Test</div>
          <div class="card-description">
            <button id="speedtest-btn" class="card-btn">Run Speed Test</button>
            <div id="speedtest-progress" class="s"></div>
            <div id="speedtest-result" class="s"></div>
          </div>
        </div>
      </div>
    </main>
  </div>
  <footer class="footer footer-center">Brad Varing &copy; 2025</footer>
  <script>
    // Connectivity check
    function updateConnectionStatus() {
      const status = navigator.onLine ? "Online" : "Offline";
      document.getElementById("connection-status").textContent = status;
    }
    window.addEventListener("online", updateConnectionStatus);
    window.addEventListener("offline", updateConnectionStatus);
    updateConnectionStatus();

    // WiFi strength (not available in most browsers, so hidden)
    // If browser supports Network Information API, show it
    if (navigator.connection && navigator.connection.downlink) {
      document.getElementById("wifi-box").style.display = "block";
      document.getElementById("wifi-strength").textContent = navigator.connection.downlink + " Mbps";
    }

    // Speed test (simple version using fetch)
    document.getElementById("speedtest-btn").onclick = async function() {
      const progress = document.getElementById("speedtest-progress");
      const result = document.getElementById("speedtest-result");
      progress.textContent = "Testing...";
      result.textContent = "";
      const testUrl = "https://speed.hetzner.de/100MB.bin"; // public test file
      const start = performance.now();
      try {
        await fetch(testUrl, { method: "GET", cache: "no-store" });
        const end = performance.now();
        const seconds = (end - start) / 1000;
        // 100MB in seconds
        const mbps = (100 / seconds).toFixed(2);
        progress.textContent = "";
        result.textContent = `Download speed: ${mbps} MB/s (approx)`;
      } catch (e) {
        progress.textContent = "";
        result.textContent = "Speed test failed.";
      }
    };
  </script>
</body>
</html>
